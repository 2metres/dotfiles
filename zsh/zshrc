# Path to Oh My Zsh
export ZSH="$HOME/.oh-my-zsh"

# Plugins
plugins=(
  git
  yarn
  npm
  python
  zsh-autosuggestions
  zsh-completions
  zsh-history-substring-search
  zsh-syntax-highlighting
)

source "$ZSH/oh-my-zsh.sh"

# Disable yarn 'y' alias
unalias y 2>/dev/null || true

# Custom aliases
alias gs='git status'
alias gll='git log --graph --pretty=oneline --abbrev-commit'

# Environment variables
export AWS_PROFILE="aidev"
export DOCKER_HOST="unix://$HOME/.colima/docker.sock"

# PATH additions
export PATH="$HOME/.local/bin:$PATH"

# Tool initializations
eval "$(starship init zsh)"
eval "$(fnm env --use-on-cd --shell zsh)"

# AWS helper functions
aws:login() {
  aws sso login --sso-session lmg-sso
  export AWS_PROFILE="aidev"
  echo "AWS SSO session started and AWS_PROFILE set to aidev."
}

aws:check-sso() {
  if aws sts get-caller-identity --output text --query 'Account' >/dev/null 2>&1; then
    echo "AWS SSO session is active (Profile: $AWS_PROFILE)"
    return 0
  else
    echo "AWS SSO session expired. Run 'aws:login' to authenticate."
    return 1
  fi
}

# Silent SSO check on startup
aws:check-sso >/dev/null 2>&1
